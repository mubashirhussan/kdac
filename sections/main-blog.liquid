<script
  src="{{ 'blog-posts-list.js' | asset_url }}"
  type="module"
  fetchpriority="low"
></script>

<blog-posts-list section-id="{{ section.id }}">
  <div class="section-background color-{{ section.settings.color_scheme }}"></div>

  <div
    class="
      section
      color-{{ section.settings.color_scheme }}
      blog-posts
      spacing-style
      size-style
    "
    style="--kb-container: {{ section.settings.container_width }}px; {% render 'spacing-style', settings: section.settings %}"
  >
    {% content_for 'blocks' %}

    {%- paginate blog.articles by 12 -%}
      <div class="kb-page">
        <div class="kb-grid" ref="grid" data-last-page="{{ paginate.pages }}">
          {% for article in blog.articles %}
            <article class="kb-card" ref="cards[]" data-page="{{ paginate.current_page }}">
              <a class="kb-card__imagewrap" href="{{ article.url }}" aria-label="{{ article.title }}">
                {% if article.image %}
                  {{ article.image | image_url: width: 1200 | image_tag: alt: article.title, loading: 'lazy' }}
                {% else %}
                  <div class="kb-card__placeholder"></div>
                {% endif %}
              </a>

              <div class="kb-card__body">
                <h3 class="kb-card__title">
                  <a href="{{ article.url }}">{{ article.title }}</a>
                </h3>

                <p class="kb-card__excerpt">
                  {% if article.excerpt != blank %}
                    {{ article.excerpt | strip_html | truncate: 140 }}
                  {% else %}
                    {{ article.content | strip_html | truncate: 140 }}
                  {% endif %}
                </p>

                <div class="kb-card__meta">
                  <time datetime="{{ article.published_at | date: "%Y-%m-%d" }}">
                    {{ article.published_at | date: "%B %d, %Y" }}
                  </time>
                </div>

                <a class="kb-card__btn" href="{{ article.url }}">Continue Reading</a>
              </div>
            </article>
          {% endfor %}
        </div>

        {%- if paginate.pages > 1 -%}
          <nav class="kb-pagination">
            {%- if paginate.previous -%}
              <a href="{{ paginate.previous.url }}" class="kb-pagination__link">Previous</a>
            {%- endif -%}
            <span class="kb-pagination__info">Page {{ paginate.current_page }} of {{ paginate.pages }}</span>
            {%- if paginate.next -%}
              <a href="{{ paginate.next.url }}" class="kb-pagination__link">Next</a>
            {%- endif -%}
          </nav>
        {%- endif -%}
      </div>
    {%- endpaginate -%}
  </div>
</blog-posts-list>

{% stylesheet %}
  /* -----------------------
     Vars / container
  ----------------------- */
  .blog-posts{
    --gap: 22px;
    --radius: 14px;
    --shadow: 0 4px 16px rgba(0,0,0,.06);
    --shadow-hover: 0 10px 24px rgba(0,0,0,.10);
    --blue: #0046ff;         /* KDAC blue */
    --blue-dark: #0033c7;
    --muted: #6b7280;
  }
  .kb-page{
    max-width: var(--kb-container, 1200px);
    margin-inline: auto;
  }

  /* -----------------------
     Grid (not full width)
  ----------------------- */
  .kb-grid{
    display:grid;
    gap:var(--gap);
    grid-template-columns:repeat(3, 1fr);
  }
  @media (max-width: 1024px){ .kb-grid{ grid-template-columns:repeat(2, 1fr); } }
  @media (max-width: 749px){ .kb-grid{ grid-template-columns:1fr; } }

  /* -----------------------
     Card
  ----------------------- */
  .kb-card{
    display:flex; flex-direction:column;
    background:#fff; border-radius:var(--radius); overflow:hidden;
    box-shadow:var(--shadow);
    transition:transform .22s ease, box-shadow .22s ease;
    height:100%;
  }
  .kb-card:hover{ transform:translateY(-3px); box-shadow:var(--shadow-hover); }

  /* Image â€“ smaller, show full */
  .kb-card__imagewrap{ display:block; background:#fff; }
  .kb-card__imagewrap img{
    width:100%;
    aspect-ratio: 4 / 3;     /* smaller thumbnail */
    object-fit: contain;     /* show full image */
    padding: 12px;           /* white breathing room around logos/products */
    display:block;
    transition: transform .28s ease;
  }
  .kb-card:hover .kb-card__imagewrap img{ transform: scale(1.03); }

  .kb-card__placeholder{
    width:100%; aspect-ratio:4/3; background:#f2f4f7;
  }

  /* Body */
  .kb-card__body{
    padding:16px 18px 18px;
    display:flex; flex-direction:column; gap:10px;
    flex:1;
  }

  .kb-card__title{ margin:0; line-height:1.3; }
  .kb-card__title a{
    color:black!important;
    font-weight:800; text-decoration:none;
    font-size: clamp(17px, 1.5vw, 20px);
    display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;
    overflow:hidden;
  }
  .kb-card__title a:hover{ color:var(--blue-dark) !important; }

  .kb-card__excerpt{
    margin:0; color:#444; line-height:1.45; font-size:.95rem;
    flex:1;                            /* pushes meta + button to bottom */
    display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical;
    overflow:hidden;
  }

  .kb-card__meta{ color:var(--muted); font-size:.9rem; }

  .kb-card__btn{
    align-self:flex-start; margin-top:8px;
    display:inline-block; padding:10px 16px; border-radius:999px;
    background:var(--blue); color:#fff !important; text-decoration:none; font-weight:800;
    transition: background .2s ease, transform .2s ease;
  }
  .kb-card__btn:hover{ background:var(--blue-dark); transform:translateY(-1px); }

  /* Pagination */
  .kb-pagination{
    display:flex; justify-content:center; align-items:center; gap:16px;
    margin-top:28px;
  }
  .kb-pagination__link{
    color:var(--blue); text-decoration:none; font-weight:700;
  }
  .kb-pagination__link:hover{ color:var(--blue-dark); }
  .kb-pagination__info{ color:var(--muted); font-size:.95rem; }
{% endstylesheet %}

{% schema %}
{
  "name": "t:names.blog_posts",
  "blocks": [
    { "type": "@theme" },
    { "type": "@app" },
    { "type": "text" },
    { "type": "icon" },
    { "type": "image" },
    { "type": "button" },
    { "type": "video" },
    { "type": "group" },
    { "type": "spacer" },
    { "type": "_divider" }
  ],
  "disabled_on": { "groups": ["header"] },
  "settings": [
    { "type": "color_scheme", "id": "color_scheme", "label": "t:settings.color_scheme", "default": "scheme-1" },
    { "type": "header", "content": "t:content.padding" },
    { "type": "range", "id": "padding-block-start", "label": "t:settings.top", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
    { "type": "range", "id": "padding-block-end", "label": "t:settings.bottom", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
    {
      "type": "range",
      "id": "container_width",
      "label": "Content width",
      "min": 800,
      "max": 1400,
      "step": 10,
      "unit": "px",
      "default": 1200
    }
  ]
}
{% endschema %}
